{% extends "base.html" %}
{% block title %}Ticket #{{ ticket.id }}{% endblock %}



{% block content %}

<a href="/tickets" class="btn btn-outline-secondary mb-3">‚Üê Volver</a>

<div class="card shadow-sm mb-3">
  <div class="card-body">
    <h4>{{ ticket.title }}</h4>

    <div class="mb-2">
      {% if ticket.status == "OPEN" %}
        <span class="badge badge-open">OPEN</span>
      {% elif ticket.status == "IN_PROGRESS" %}
        <span class="badge badge-in-progress">IN_PROGRESS</span>
      {% else %}
        <span class="badge badge-resolved">RESOLVED</span>
      {% endif %}
    </div>

    <p>{{ ticket.description }}</p>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <h5>Comentarios</h5>

    {% for c in comments %}
      <div class="list-group-item comment-item mb-2">
        <strong>{{ c.user_name }}</strong>
        <small class="text-muted ms-2">{{ c.created_at }}</small>
        <div>{{ c.comment }}</div>
      </div>
    {% endfor %}

    {% if comments|length == 0 %}
      <p class="text-muted">No hay comentarios.</p>
    {% endif %}

    {% if user_role != "INACTIVE" %}
      <form id="commentForm" class="mt-3">
        <textarea id="commentText" class="form-control mb-2" rows="3" required></textarea>
        <button class="btn btn-outline-primary">Enviar comentario</button>
      </form>
    {% endif %}
  </div>
</div>

{% endblock %}